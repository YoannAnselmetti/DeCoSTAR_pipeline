DeCoSTAR_linux_2016-12-13: binary DeCoSTAR file, compiled (static) for Linux.

linearize_assign_scj.sh:
- linearize the genomes, both extant and ancestral
- assigns fragments to X chromosome or autosomes
- detects SCJ rearrangements


run_decostar_breezy_2016-12-13.sh:
launching the script linearize_assign_scj.sh on all three data sets in the results/decostar directory
launch command: qsub run_decostar_breezy_2016-12-13.sh


run_validation_breezy_[Aalb,Aara,Adir]_2016-12-13.sh:
launching the linearization data sets in the results/validation_ADseq directory
launch command:qsub run_validation_breezy_Aalb_2016-12-13.sh
qsub run_validation_breezy_Aara_2016-12-13.sh
qsub run_validation_breezy_Adir_2016-12-13.sh
launch command: qsub run_validation_breezy_2016-12-13.sh


##############################
### "pipeline_input_decostar" directory
##############################
scripts to generate the input to DeCoSTAR from the raw data
=> Contains all scripts necessary to transform INPUT DATA contained in directory data/INPUT_DATA in data necessary to execute DeCoSTAR on Anopheles dataset
(Reference genome assemblies that should be present in directory "data/INPUT_DATA/FASTA/SCAFF" are not present cause take too much place)


run_scripts_00-07.sh:
Execute the step 00 to 07, processing GFF files and raw gene trees to produced clean gene trees, inlcuded genes file and first draft of gene annotation (that should be refined after gen trees inference)
- 00-clean_gene_trees.sh 						=> concatenate and clean raw gene trees files by removing empty trees and adding "\n" where it is necessary
- 01_create_name_ID_asso_file_WH.sh 			=> produce an species name and ID association to process GFF files  
- 02_sort_GFF_files_WH.sh 						=> sort GFF files (1 file/species)
- 03_parser_GFF_in_GENE_file_WH.py 				=> Transform GFF files in GENE files (GFF file gives position of exon on genome assemblies)
- 04a_sort_GENE_files.sh						=> sort GENE files (1 file/species)
- 04b-filter_species_in_gene_trees.py			=> remove Anophles stephensi (INDIAN strain) from gene trees
- 04c_filter_GENEfile_with_GeneTrees.py			=> filter gene that are not present in gene trees from GENE files
- 05_parser_GENE_file_in_Graph.py				=> process GENE files to determine overlapping and included genes and compute stats on gene (graph) and cproduce 1 gene annotation file for all species
- 06-add_GeneFamily_ID.py						=> add gene family ID to gene annotation for all species
- 07-filter_GeneTrees_with_IncludedGenes_WH.sh	=> Filter gene trees with included gene before to better inferred gene trees 


08-pipeline_to_infer_GeneTrees.sh:
Pipeline to infer gene trees from gene families contained in filtered gene trees (!!! To execute on ISEM cluster !!!)
- "08-infer_gene_trees" directory


run_scripts_09-10_12-14.sh:
Execute step 09 to 14 except, step 11 (scaffolding step) that should be done on ISEM cluster. BESST results are available on "data/DATA_SEQ/SCAFFOLDING" directory. To execute step 10 it is necessary to have genome assemblies that are not present in GitHub repository cause they are too heavy. 
- Scripts 09+10:
	Creation of gene annotation file to determined observed adjacencies in Anopheles genomes + Contig/Scaffolds file that will be used to determined scaffolding gene adjacencies.
	- 09-filter_Gene_with_geneTrees.py		=> Filter gene that are not present in gene trees obtained after gene trees inference pipeline
	- 10-create_CTG_file.py					=> Create contig file that will be sued to determine scaffolding gene adajcencies computed during step 11

- Scripts 11:
	Directory containing all scripts to generate scaffolding adjacencies from paired sequencing data (!!! To execute on ISEM cluster !!!)
	- 11-compute_scaffolding_adjacencies

- Scripts 12a/b:
	Determined scaffolding gene adajcencies from BESST results
	- 12a-create_scaff_adj_prefile.py		=> Pre-processing of BESST results, filter scaffolding adjacencies with links number <4 and filter redondant contigs pairs between libraries keeping only  
	- 12b-create_scaff_adj_file_final.py	=> Use contig file to determine gene couples linked by seq data (!!! TO MODIFY: if 2 pairs give the same pair of genes but with different orientation, then we keep only orientation with the best BESST score!!! => NOT FINE SINCE DECOSTAR TAKES INTO ACCOUNT ORIENTATION!!!)

- Scripts 13+14:
	Produce INPUT files for DeCoSTAR from files previously generated
	- 13-create_ADJfile_for_DeCoSTAR.py						=> Compute adjacencies file for DeCoSTAR from gene annotation file (computed in step 09) and scaffolding gene adjacencies (computed in step 12)
	- 14-write_1tree_per_file.py							=> From gene trees produced after step 08, create a directory with 1 file / gene tree and file with path to gene trees (As to be run twice (X_topo and WG_topo)
	- 14bisA-add_speciesName_to_geneID_for_RAW_trees.sh		=> Add species name to raw gene trees to be readable by DeCoSTAR
	- 14bisB-write_1tree_per_file_for_RAW_trees.py			=> Restrict raw geentrees to gene trees present after pipeline to better infer gene trees 

!!! For now, parameter files of DeCoSTAR are handwritten !!!





#######################################################################
###   VALIDATION of NEW ADJACENCIES BY REDUCING ASSEMBLY COVERAGE   ###
#######################################################################


###############################################
###   GENOME ASEMBLY with MINIA (Cluster)   ###
###############################################

1/ READS SAMPLING
2/ List FASTQ files
3/ Get otpimal kmer size from FASTQ files list with KmerGenie
4/ Assemble genomes with MINIA algorithm
5/ Command line to get stats on assembly


1/ REDUCING NUMBER OF FASTQ READS IN INPUT FILE (Use HTSeq python module):

	qsub -N "reduceFASTQ_Aalb" -cwd -l h_rt=200000:00:00,s_rt=200000:00:00 -b y "$HOME/Anopheles_project/script/valid_by_coverage/reduce_pairedFASTQ_files.py 0.5 /share/nas-isem_f/phylogenie_et_evolution_moleculaire/yoann/VALIDATION_by_COVERAGE/FASTQ/ALL/Anopheles_albimanus/"

	qsub -N "reduceFASTQ_Aara" -cwd -l h_rt=200000:00:00,s_rt=200000:00:00 -b y "$HOME/Anopheles_project/script/valid_by_coverage/reduce_pairedFASTQ_files.py 0.5 /share/nas-isem_f/phylogenie_et_evolution_moleculaire/yoann/VALIDATION_by_COVERAGE/FASTQ/ALL/Anopheles_arabiensis/"

	qsub -N "reduceFASTQ_Adir" -cwd -l h_rt=200000:00:00,s_rt=200000:00:00 -b y "$HOME/Anopheles_project/script/valid_by_coverage/reduce_pairedFASTQ_files.py 0.5 /share/nas-isem_f/phylogenie_et_evolution_moleculaire/yoann/VALIDATION_by_COVERAGE/FASTQ/ALL/Anopheles_dirus/"


2/ Get list of FASTQ files:

	ALL:
        ls -1 /share/nas-isem_f/phylogenie_et_evolution_moleculaire/yoann/VALIDATION_by_COVERAGE/FASTQ/ALL/Anopheles_albimanus/SRX*/*/* > $HOME/Anopheles_project/VALIDATION_by_COVERAGE/list_ALL_FASTQ_Aalb.txt

        ls -1 /share/nas-isem_f/phylogenie_et_evolution_moleculaire/yoann/VALIDATION_by_COVERAGE/FASTQ/ALL/Anopheles_arabiensis/SRX*/*/* > $HOME/Anopheles_project/VALIDATION_by_COVERAGE/list_ALL_FASTQ_Aara.txt

        ls -1 /share/nas-isem_f/phylogenie_et_evolution_moleculaire/yoann/VALIDATION_by_COVERAGE/FASTQ/ALL/Anopheles_dirus/SRX*/*/* > $HOME/Anopheles_project/VALIDATION_by_COVERAGE/list_ALL_FASTQ_Adir.txt
	50%:
        ls -1 /share/nas-isem_f/phylogenie_et_evolution_moleculaire/yoann/VALIDATION_by_COVERAGE/FASTQ/50pourc/Anopheles_albimanus/SRX*/*/* > $HOME/Anopheles_project/VALIDATION_by_COVERAGE/list_50pourc_FASTQ_Aalb.txt

        ls -1 /share/nas-isem_f/phylogenie_et_evolution_moleculaire/yoann/VALIDATION_by_COVERAGE/FASTQ/50pourc/Anopheles_arabiensis/SRX*/*/* > $HOME/Anopheles_project/VALIDATION_by_COVERAGE/list_50pourc_FASTQ_Aara.txt

        ls -1 /share/nas-isem_f/phylogenie_et_evolution_moleculaire/yoann/VALIDATION_by_COVERAGE/FASTQ/50pourc/Anopheles_dirus/SRX*/*/* > $HOME/Anopheles_project/VALIDATION_by_COVERAGE/list_50pourc_FASTQ_Adir.txt



3/ Get optimal kmer size for genome assembler (here: minia) with KmerGenie:

	ALL:
		qsub -N 'kg_Aalb_ALL' -cwd -l h_rt=200000:00:00,s_rt=200000:00:00 -b y "Software/KMER/kmergenie-1.7016/kmergenie VALIDATION_by_COVERAGE/list_ALL_FASTQ_Aalb.txt -o VALIDATION_by_COVERAGE/kmergenie/Anopheles_albimanus/ALL/kmergenie_Aara_ALL_histograms"

		qsub -N 'kg_Aara_ALL' -cwd -l h_rt=200000:00:00,s_rt=200000:00:00 -b y "Software/KMER/kmergenie-1.7016/kmergenie VALIDATION_by_COVERAGE/list_ALL_FASTQ_Aara.txt -o VALIDATION_by_COVERAGE/kmergenie/Anopheles_arabiensis/ALL/kmergenie_Aara_ALL_histograms"

		qsub -N 'kg_Adir_ALL' -cwd -l h_rt=200000:00:00,s_rt=200000:00:00 -b y "Software/KMER/kmergenie-1.7016/kmergenie VALIDATION_by_COVERAGE/list_ALL_FASTQ_Adir.txt -o VALIDATION_by_COVERAGE/kmergenie/Anopheles_dirus/ALL/kmergenie_Adir_ALL_histograms"
	50%:
		qsub -N 'kg_Aalb_50pourc' -cwd -l h_rt=200000:00:00,s_rt=200000:00:00 -b y "Software/KMER/kmergenie-1.7016/kmergenie VALIDATION_by_COVERAGE/list_50pourc_FASTQ_Aalb.txt -o VALIDATION_by_COVERAGE/kmergenie/Anopheles_albimanus/50pourc/kmergenie_Aalb_50pourc_histograms"

		qsub -N 'kg_Aara_50pourc' -cwd -l h_rt=200000:00:00,s_rt=200000:00:00 -b y "Software/KMER/kmergenie-1.7016/kmergenie VALIDATION_by_COVERAGE/list_50pourc_FASTQ_Aara.txt -o VALIDATION_by_COVERAGE/kmergenie/Anopheles_arabiensis/50pourc/kmergenie_Aalb_50pourc_histograms"

		qsub -N 'kg_Adir_50pourc' -cwd -l h_rt=200000:00:00,s_rt=200000:00:00 -b y "Software/KMER/kmergenie-1.7016/kmergenie VALIDATION_by_COVERAGE/list_50pourc_FASTQ_Adir.txt -o VALIDATION_by_COVERAGE/kmergenie/Anopheles_dirus/50pourc/kmergenie_Adir_50pourc_histograms"


4/ Assemble genomes with minia:

	ALL:
        qsub -N 'minia_Aalb_ALL' -q mem.q -cwd -l h_rt=200000:00:00,s_rt=200000:00:00 -b y "mkdir -p /share/nas-isem_f/phylogenie_et_evolution_moleculaire/yoann/VALIDATION_by_COVERAGE/minia/Anopheles_albimanus/ALL; $HOME/Software/ASSEMBLY/minia-2.0.3-Source/build/minia -in $HOME/Anopheles_project/VALIDATION_by_COVERAGE/list_ALL_FASTQ_Aalb.txt -kmer-size 83 -abundance-min 3 -out /share/nas-isem_f/phylogenie_et_evolution_moleculaire/yoann/VALIDATION_by_COVERAGE/minia/Anopheles_albimanus/ALL/minia_k83_m3_Aalb_ALL"

        qsub -N 'minia_Aara_ALL' -q mem.q -cwd -l h_rt=200000:00:00,s_rt=200000:00:00 -b y "mkdir -p /share/nas-isem_f/phylogenie_et_evolution_moleculaire/yoann/VALIDATION_by_COVERAGE/minia/Anopheles_arabiensis/ALL; $HOME/Software/ASSEMBLY/minia-2.0.3-Source/build/minia -in $HOME/Anopheles_project/VALIDATION_by_COVERAGE/list_ALL_FASTQ_Aara.txt -kmer-size 69 -abundance-min 3 -out /share/nas-isem_f/phylogenie_et_evolution_moleculaire/yoann/VALIDATION_by_COVERAGE/minia/Anopheles_arabiensis/ALL/minia_k69_m3_Aara_ALL"

        qsub -N 'minia_Adir_ALL' -q mem.q -cwd -l h_rt=200000:00:00,s_rt=200000:00:00 -b y "mkdir -p /share/nas-isem_f/phylogenie_et_evolution_moleculaire/yoann/VALIDATION_by_COVERAGE/minia/Anopheles_dirus/ALL; $HOME/Software/ASSEMBLY/minia-2.0.3-Source/build/minia -in $HOME/Anopheles_project/VALIDATION_by_COVERAGE/list_ALL_FASTQ_Adir.txt -kmer-size 75 -abundance-min 3 -out /share/nas-isem_f/phylogenie_et_evolution_moleculaire/yoann/VALIDATION_by_COVERAGE/minia/Anopheles_dirus/ALL/minia_k75_m3_Adir_ALL"
	50%:
		qsub -N 'minia_Aalb_50pourc' -q mem.q -cwd -l h_rt=200000:00:00,s_rt=200000:00:00 -b y "mkdir -p /share/nas-isem_f/phylogenie_et_evolution_moleculaire/yoann/VALIDATION_by_COVERAGE/minia/Anopheles_albimanus/50pourc; $HOME/Software/ASSEMBLY/minia-2.0.3-Source/build/minia -in $HOME/Anopheles_project/VALIDATION_by_COVERAGE/list_50pourc_FASTQ_Aalb.txt -kmer-size 75 -abundance-min 3 -out /share/nas-isem_f/phylogenie_et_evolution_moleculaire/yoann/VALIDATION_by_COVERAGE/minia/Anopheles_albimanus/50pourc/minia_k75_m3_Aalb_50pourc"

		qsub -N 'minia_Aara_50pourc' -q mem.q -cwd -l h_rt=200000:00:00,s_rt=200000:00:00 -b y "mkdir -p /share/nas-isem_f/phylogenie_et_evolution_moleculaire/yoann/VALIDATION_by_COVERAGE/minia/Anopheles_arabiensis/50pourc $HOME/Software/ASSEMBLY/minia-2.0.3-Source/build/minia -in $HOME/Anopheles_project/VALIDATION_by_COVERAGE/list_50pourc_FASTQ_Aara.txt -kmer-size 59 -abundance-min 3 -out /share/nas-isem_f/phylogenie_et_evolution_moleculaire/yoann/VALIDATION_by_COVERAGE/minia/Anopheles_arabiensis/50pourc/minia_k59_m3_Aara_50pourc"

        qsub -N 'minia_Adir_50pourc' -q mem.q -cwd -l h_rt=200000:00:00,s_rt=200000:00:00 -b y "mkdir -p /share/nas-isem_f/phylogenie_et_evolution_moleculaire/yoann/VALIDATION_by_COVERAGE/minia/Anopheles_dirus/50pourc $HOME/Software/ASSEMBLY/minia-2.0.3-Source/build/minia -in $HOME/Anopheles_project/VALIDATION_by_COVERAGE/list_50pourc_FASTQ_Adir.txt -kmer-size 63 -abundance-min 3 -out /share/nas-isem_f/phylogenie_et_evolution_moleculaire/yoann/VALIDATION_by_COVERAGE/minia/Anopheles_dirus/50pourc/minia_k63_m3_Adir_50pourc"


5/ Stats on assembly:

	N50(bp) + (#CTG>=N50):
		WORKING_PROJECT/fixed_params_160407/script/validation_coverage/calcN50.pl -f /share/nas-isem_f/phylogenie_et_evolution_moleculaire/yoann/VALIDATION_by_COVERAGE/minia/Anopheles_albimanus/ALL/minia_k83_m3_Aalb_ALL.contigs.fa -l 0

	#CTG:
		=> See in output lof file ".o" line with TAG "nb_contigs".
		grep -c \> VALIDATION_by_COVERAGE/minia/Anopheles_albimanus/ALL/minia_k83_m3_Aalb_ALL.contigs.fa

	#CTG>=1000bp:
		grep \> VALIDATION_by_COVERAGE/minia/Anopheles_albimanus/ALL/minia_k83_m3_Aalb_ALL.contigs.fa | awk -F"__" '{if ($3>=1000) sum+=1} END {print sum}'

	Assembly size:
		=> See in output lof file ".o" line with TAG "nt_assembled"
		grep \> VALIDATION_by_COVERAGE/minia/Anopheles_albimanus/ALL/minia_k83_m3_Aalb_ALL.contigs.fa | awk -F"__" '{sum+=$3} END {print sum}'



######################################
###   SCAFFOLDING step (Cluster)   ###
######################################
 
1/ INDEX minia genome assembly
2/ Map paired-reads on genome assembly (Bowtie with 50 best alignments)
3/ Merge BAM files
4/ Compute scaffolding contig adjacencies with BESST


1/ INDEX reference genome with "Bowtie2-build" (Ã€ la main):

	ALL:
		/home/yanselmetti/Software/MAPPING/bowtie2-2.2.9/bowtie2-build -o 5 /share/nas-isem_f/phylogenie_et_evolution_moleculaire/yoann/VALIDATION_by_COVERAGE/minia/Anopheles_arabiensis/ALL/minia_k72_m3_Aara_ALL.contigs.fa /share/nas-isem_f/phylogenie_et_evolution_moleculaire/yoann/VALIDATION_by_COVERAGE/INDEX/Anopheles_arabiensis/ALL/Anopheles_arabiensis_ALL

	50%:
		/home/yanselmetti/Software/MAPPING/bowtie2-2.2.9/bowtie2-build -o 5 /share/nas-isem_f/phylogenie_et_evolution_moleculaire/yoann/VALIDATION_by_COVERAGE/minia/Anopheles_arabiensis/50pourc/minia_k59_m3_Aara_50pourc.contigs.fa /share/nas-isem_f/phylogenie_et_evolution_moleculaire/yoann/VALIDATION_by_COVERAGE/INDEX/Anopheles_arabiensis/50pourc/Anopheles_arabiensis_50pourc

2/ Mapping of reads on genome assembly:

	ALL:
		$HOME/Anopheles_project/script/cluster/cluster_ISEM/run_MAPPING.sh Bowtie2 /share/nas-isem_f/phylogenie_et_evolution_moleculaire/yoann/VALIDATION_by_COVERAGE/FASTQ/ALL/Anopheles_arabiensis Bowtie2_X_50 /share/nas-isem_f/phylogenie_et_evolution_moleculaire/yoann/VALIDATION_by_COVERAGE/INDEX/Anopheles_arabiensis/ALL/Anopheles_arabiensis_ALL_k72 ALL

	50%:
		$HOME/Anopheles_project/script/cluster/cluster_ISEM/run_MAPPING.sh Bowtie2 /share/nas-isem_f/phylogenie_et_evolution_moleculaire/yoann/VALIDATION_by_COVERAGE/FASTQ/50pourc/Anopheles_arabiensis Bowtie2_X_50 /share/nas-isem_f/phylogenie_et_evolution_moleculaire/yoann/VALIDATION_by_COVERAGE/INDEX/Anopheles_arabiensis/50pourc/Anopheles_arabiensis_50pourc 50pourc

	

3/ Merge BAM before to scaffold reads:

	$HOME/Anopheles_project/script/cluster/cluster_ISEM/merge_BAM.sh /share/nas-isem_f/phylogenie_et_evolution_moleculaire/yoann/VALIDATION_by_COVERAGE/MAPPING/Bowtie2_X_50/50pourc/Anopheles_arabiensis 50pourc

	$HOME/Anopheles_project/script/cluster/cluster_ISEM/merge_BAM.sh /share/nas-isem_f/phylogenie_et_evolution_moleculaire/yoann/VALIDATION_by_COVERAGE/MAPPING/Bowtie2_X_50/ALL/Anopheles_arabiensis ALL

4/ Scaffolding of reads on MINIA genome assembly:

	$HOME/Anopheles_project/script/cluster/cluster_ISEM/run_SCAFFOLDING.sh /share/nas-isem_f/phylogenie_et_evolution_moleculaire/yoann/VALIDATION_by_COVERAGE/MAPPING/Bowtie2_X_50/50pourc/Anopheles_arabiensis BESST BESST-2.2.5 /share/nas-isem_f/phylogenie_et_evolution_moleculaire/yoann/VALIDATION_by_COVERAGE/minia/Anopheles_arabiensis/50pourc/minia_k59_m3_Aara_50pourc.contigs.fa 50pourc $HOME/Anopheles_project/orientation_libraries

	$HOME/Anopheles_project/script/cluster/cluster_ISEM/run_SCAFFOLDING.sh /share/nas-isem_f/phylogenie_et_evolution_moleculaire/yoann/VALIDATION_by_COVERAGE/MAPPING/Bowtie2_X_50/ALL/Anopheles_arabiensis BESST BESST-2.2.5 /share/nas-isem_f/phylogenie_et_evolution_moleculaire/yoann/VALIDATION_by_COVERAGE/minia/Anopheles_arabiensis/ALL/minia_k72_m3_Aara_ALL.contigs.fa ALL $HOME/Anopheles_project/orientation_libraries



###############################################
### Scripts in "validation_ADseq" directory ###
###############################################

Scripts to produce INPUT files for DeCoSTAR:

run_ALL_exp_BLASTn.sh:
	Execute the 6 experiments for the validation of ADseq algo with BLASTn alignment
		=> 3 species (Aalb, Aara & Adir) x 2 reads sampling (50% & ALL)

00-run_ALL_script_BLASTn.sh
	Script to run all scripts for 1 experiment

	01-run_blastn.sh									=> 
	02-filter_BLASTn_results.py
	03-filter_geneTrees_with_geneList_BLASTn.sh
	04-filter_Gene_with_geneTrees_BLASTn.py
	05a-create_CTG_file_BLASTn.py
	05b-create_CTG_file_ORI_BLASTn.py
	06a-create_scaff_adj_prefile_BLASTn.py
	06b-modif_scaff_adj_prefile_BLASTn.py
	06c-create_scaff_adj_file_final_BLASTn.py
	07-fusion_MINIA_ORI_file_BLASTn.sh
	08-create_ADJfile_for_DeCoSTAR_BLASTn.py
	09-write_1tree_per_file_for_DeCoSTAR_BLASTn.py